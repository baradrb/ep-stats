
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Evaluation package for experimentation platform." name="description"/>
<link href="https://github.com/avast/ep-stats/stats/multiple.html" rel="canonical"/>
<meta content="Team Doodlebug" name="author"/>
<link href="../experiment_b.png" rel="shortcut icon"/>
<meta content="mkdocs-1.1.2, mkdocs-material-5.5.12" name="generator"/>
<title>Multiple Comparison Correction - Ep-Stats</title>
<link href="../assets/stylesheets/main.4dd2dd8d.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
</head>
<body dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#multiple-comparison-correction">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header-nav md-grid">
<a aria-label="Ep-Stats" class="md-header-nav__button md-logo" href="https://github.com/avast/ep-stats" title="Ep-Stats">
<img alt="logo" src="../experiment_w.png"/>
</a>
<label class="md-header-nav__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg>
</label>
<div class="md-header-nav__title" data-md-component="header-title">
<div class="md-header-nav__ellipsis">
<span class="md-header-nav__topic md-ellipsis">
            Ep-Stats
          </span>
<span class="md-header-nav__topic md-ellipsis">
            
              Multiple Comparison Correction
            
          </span>
</div>
</div>
<label class="md-header-nav__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" data-md-state="active" name="query" placeholder="Search" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</label>
<button aria-label="Clear" class="md-search__icon md-icon" data-md-component="search-reset" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header-nav__source">
<a class="md-source" href="https://github.com/avast/ep-stats/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    avast/ep-stats
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Tabs" class="md-tabs md-tabs--active" data-md-component="tabs">
<div class="md-tabs__inner md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../index.html">
          Home
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../user_guide/quick_start.html">
          User Guide
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link md-tabs__link--active" href="basics.html">
          Statistics
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../api/experiment.html">
          API
        </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Ep-Stats" class="md-nav__button md-logo" href="https://github.com/avast/ep-stats" title="Ep-Stats">
<img alt="logo" src="../experiment_w.png"/>
</a>
    Ep-Stats
  </label>
<div class="md-nav__source">
<a class="md-source" href="https://github.com/avast/ep-stats/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    avast/ep-stats
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="nav-1" id="nav-1" type="checkbox"/>
<label class="md-nav__link" for="nav-1">
      Home
      <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Home" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="nav-1">
<span class="md-nav__icon md-icon"></span>
        Home
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../index.html" title="Introduction">
      Introduction
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../principles.html" title="Principles">
      Principles
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../resources.html" title="Resources">
      Resources
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" id="nav-2" type="checkbox"/>
<label class="md-nav__link" for="nav-2">
      User Guide
      <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="User Guide" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="nav-2">
<span class="md-nav__icon md-icon"></span>
        User Guide
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../user_guide/quick_start.html" title="Quick Start">
      Quick Start
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../user_guide/protocol.html" title="Experimentation Protocol">
      Experimentation Protocol
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../user_guide/ep_in_python.ipynb" title="Using Ep-Stats in Jupyter">
      Using Ep-Stats in Jupyter
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../user_guide/aggregation.html" title="Aggregation">
      Aggregation
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../user_guide/configuring_api.html" title="Configuring API">
      Configuring API
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../user_guide/test_data.html" title="Test Data">
      Test Data
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="nav-3" id="nav-3" type="checkbox"/>
<label class="md-nav__link" for="nav-3">
      Statistics
      <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Statistics" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="nav-3">
<span class="md-nav__icon md-icon"></span>
        Statistics
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="basics.html" title="Basics">
      Basics
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="sample_size.html" title="Sample Size">
      Sample Size
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="sequential.html" title="Sequential Evaluation">
      Sequential Evaluation
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="ctr.html" title="CTR Metric Redefined">
      CTR Metric Redefined
    </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
        Multiple Comparison Correction
        <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="multiple.html" title="Multiple Comparison Correction">
      Multiple Comparison Correction
    </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#summary">
    Summary
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#multiple-comparisons-problem">
    Multiple Comparisons Problem
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#bonferroni-correction">
    Bonferroni correction
  </a>
<nav aria-label="Bonferroni correction" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#algorithm">
    Algorithm
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#example">
    Example
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#holmbonferroni-method">
    HolmBonferroni method
  </a>
<nav aria-label="HolmBonferroni method" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#algorithm_1">
    Algorithm
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#example_1">
    Example
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#idk-correction">
    idk correction
  </a>
<nav aria-label="idk correction" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#algorithm-for-alphaalpha">
    Algorithm (for \alpha\alpha)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#algorithm-for-p-values">
    Algorithm (for p-values)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#example_2">
    Example
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#confidence-interval-adjustment">
    Confidence Interval Adjustment
  </a>
<nav aria-label="Confidence Interval Adjustment" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#algorithm_2">
    Algorithm
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#example_3">
    Example
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#python-package">
    Python package
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" id="nav-4" type="checkbox"/>
<label class="md-nav__link" for="nav-4">
      API
      <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="API" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="nav-4">
<span class="md-nav__icon md-icon"></span>
        API
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../api/experiment.html" title="Experiment">
      Experiment
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/evaluation.html" title="Evaluation">
      Evaluation
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/statistics.html" title="Statistics">
      Statistics
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/check.html" title="Check">
      Check
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/srm_check.html" title="SrmCheck">
      SrmCheck
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/dao.html" title="Dao">
      Dao
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/dao_factory.html" title="DaoFactory">
      DaoFactory
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/test_data.html" title="TestData">
      TestData
    </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#summary">
    Summary
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#multiple-comparisons-problem">
    Multiple Comparisons Problem
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#bonferroni-correction">
    Bonferroni correction
  </a>
<nav aria-label="Bonferroni correction" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#algorithm">
    Algorithm
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#example">
    Example
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#holmbonferroni-method">
    HolmBonferroni method
  </a>
<nav aria-label="HolmBonferroni method" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#algorithm_1">
    Algorithm
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#example_1">
    Example
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#idk-correction">
    idk correction
  </a>
<nav aria-label="idk correction" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#algorithm-for-alphaalpha">
    Algorithm (for \alpha\alpha)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#algorithm-for-p-values">
    Algorithm (for p-values)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#example_2">
    Example
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#confidence-interval-adjustment">
    Confidence Interval Adjustment
  </a>
<nav aria-label="Confidence Interval Adjustment" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#algorithm_2">
    Algorithm
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#example_3">
    Example
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#python-package">
    Python package
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/avast/ep-stats/edit/master/docs/stats/multiple.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"></path></svg>
</a>
<h1 id="multiple-comparison-correction">Multiple Comparison Correction<a class="headerlink" href="#multiple-comparison-correction" title="Permanent link">¶</a></h1>
<p>Multiple comparisons problem is a problem, when we perform instead of one statistical test (i.e. difference between A and B variant) multiple statistical tests (i.e. difference between A and B, A and C, A and D). Some of them may have p-values less than 0.05 purely by chance, even if all our null hypotheses are really true.</p>
<p>There exist various solutions. They differ mainly in power and implementation difficulty. We present one-by-one Bonferroni correction, HolmBonferroni method and Sidak correction. We summarize pros and cons of methods and provide step-by-step algorithms. Finally we present simple example in order to compare suggested methods.</p>
<p>Generally HolmBonferroni method and the idk correction are universally more powerful procedures than the Bonferroni correction. Bonferroni correction is the most conservative one and suitable for independent tests.</p>
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">¶</a></h2>
<p>After taking into account computational difficulty and results from a simple, but quite real example, we suggest to use Holm-Bonferroni method.</p>
<h2 id="multiple-comparisons-problem">Multiple Comparisons Problem<a class="headerlink" href="#multiple-comparisons-problem" title="Permanent link">¶</a></h2>
<p>Source <a href="https://en.wikipedia.org/wiki/Multiple_comparisons_problem">Multiple comparisons problem (Wikipedia)</a>.</p>
<p>Let assume we want to test <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> null hypotheses <span><span class="MathJax_Preview">H_{0}^{1}, \dots, H_{0}^{m}</span><script type="math/tex">H_{0}^{1}, \dots, H_{0}^{m}</script></span>. Let denote by <span><span class="MathJax_Preview">\alpha</span><script type="math/tex">\alpha</script></span> our overall level of significance. Typically we set <span><span class="MathJax_Preview">\alpha = 0.05</span><script type="math/tex">\alpha = 0.05</script></span>. For each hull hypotheses we calculate p-values <span><span class="MathJax_Preview">p_{1}, \dots, p_{m}</span><script type="math/tex">p_{1}, \dots, p_{m}</script></span>. We need to adjust these p-values for individual hypotheses <span><span class="MathJax_Preview">H_{0}^{i}</span><script type="math/tex">H_{0}^{i}</script></span>, <span><span class="MathJax_Preview">i = 1, \dots, m</span><script type="math/tex">i = 1, \dots, m</script></span> in order to satisfy overall level of significance <span><span class="MathJax_Preview">\alpha</span><script type="math/tex">\alpha</script></span>.</p>
<h2 id="bonferroni-correction">Bonferroni correction<a class="headerlink" href="#bonferroni-correction" title="Permanent link">¶</a></h2>
<p>Source <a href="https://en.wikipedia.org/wiki/Bonferroni_correction">Bonferroni correction (Wikipedia)</a>.</p>
<p>This is the simplest way how to deal with Multiple comparisons problem. It is easy to implement, on the other hand, it is too conservative and tests loose too much power. This correction works in the worst-case scenario that all tests are independent. Since we test difference between A and B, A and C, A and D variant, these tests are dependent and therefore this correction is too stringent.</p>
<h3 id="algorithm">Algorithm<a class="headerlink" href="#algorithm" title="Permanent link">¶</a></h3>
<ol>
<li>Compute p-values <span><span class="MathJax_Preview">p_{1}, \dots, p_{m}</span><script type="math/tex">p_{1}, \dots, p_{m}</script></span> for all <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> hypotheses <span><span class="MathJax_Preview">H_{0}^{1}, \dots, H_{0}^{m}</span><script type="math/tex">H_{0}^{1}, \dots, H_{0}^{m}</script></span>.</li>
<li>Compute adjusted p-values using formula </li>
</ol>
<div>
<div class="MathJax_Preview">\tilde{p}_{i} = \min \big\{ m \, p_{i}, 1 \big\}, \,\,\, i = 1, \dots, m</div>
<script type="math/tex; mode=display">\tilde{p}_{i} = \min \big\{ m \, p_{i}, 1 \big\}, \,\,\, i = 1, \dots, m</script>
</div>
<ol>
<li>Reject null hypothesis <span><span class="MathJax_Preview">H_{0}^{i}</span><script type="math/tex">H_{0}^{i}</script></span> if and only if <span><span class="MathJax_Preview">\tilde{p}_{i} \leq \alpha</span><script type="math/tex">\tilde{p}_{i} \leq \alpha</script></span>.</li>
</ol>
<h3 id="example">Example<a class="headerlink" href="#example" title="Permanent link">¶</a></h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">statsmodels.stats.multitest</span>
<span class="n">pvals</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">]</span>

<span class="n">decision</span><span class="p">,</span> <span class="n">adj_pvals</span><span class="p">,</span> <span class="n">sidak_aplha</span><span class="p">,</span> <span class="n">bonf_alpha</span> <span class="o">=</span> <span class="n">statsmodels</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">multitest</span><span class="o">.</span><span class="n">multipletests</span><span class="p">(</span><span class="n">pvals</span><span class="o">=</span><span class="n">pvals</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">'bonferroni'</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Original p-values: </span><span class="se">\t</span><span class="s1"> </span><span class="si">{</span><span class="n">pvals</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Adjusted p-values: </span><span class="se">\t</span><span class="s1"> </span><span class="si">{</span><span class="n">adj_pvals</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code><span class="err">Original p-values:   [0.01, 0.04, 0.03]</span>
<span class="err">Adjusted p-values:   [0.03 0.12 0.09]</span>
</code></pre></div>
<h2 id="holmbonferroni-method">HolmBonferroni method<a class="headerlink" href="#holmbonferroni-method" title="Permanent link">¶</a></h2>
<p>Source <a href="https://en.wikipedia.org/wiki/HolmBonferroni_method">HolmBonferroni method (Wikipedia)</a>.</p>
<p>Holm-Bonferroni method is more powerful than Bonferroni and it is valid under the same assumptions.</p>
<h3 id="algorithm_1">Algorithm<a class="headerlink" href="#algorithm_1" title="Permanent link">¶</a></h3>
<ol>
<li>Compute p-values <span><span class="MathJax_Preview">p_{1}, \dots, p_{m}</span><script type="math/tex">p_{1}, \dots, p_{m}</script></span> for all <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> hypotheses <span><span class="MathJax_Preview">H_{0}^{1}, \dots, H_{0}^{m}</span><script type="math/tex">H_{0}^{1}, \dots, H_{0}^{m}</script></span>.</li>
<li>Order p-values from lowest to highest <span><span class="MathJax_Preview">p_{(1)} \leq \dots \leq p_{(m)}</span><script type="math/tex">p_{(1)} \leq \dots \leq p_{(m)}</script></span></li>
<li>Let <span><span class="MathJax_Preview">k</span><script type="math/tex">k</script></span> be the minimal index such that <span><span class="MathJax_Preview">p_{k} (m + 1 - k) &gt; \alpha</span><script type="math/tex">p_{k} (m + 1 - k) > \alpha</script></span>.</li>
<li>Reject the null hypotheses <span><span class="MathJax_Preview">H_{0}^{(1)}, \dots, H_{0}^{(k-1)}</span><script type="math/tex">H_{0}^{(1)}, \dots, H_{0}^{(k-1)}</script></span> and do not reject <span><span class="MathJax_Preview">H_{0}^{(k)}, \dots, H_{0}^{(m)}</span><script type="math/tex">H_{0}^{(k)}, \dots, H_{0}^{(m)}</script></span>.</li>
<li>If <span><span class="MathJax_Preview">k = 1</span><script type="math/tex">k = 1</script></span> then do not reject any of the null hypotheses and if no such <span><span class="MathJax_Preview">k</span><script type="math/tex">k</script></span> index exist then reject all of the null hypotheses.</li>
</ol>
<h3 id="example_1">Example<a class="headerlink" href="#example_1" title="Permanent link">¶</a></h3>
<div class="codehilite"><pre><span></span><code><span class="n">decision</span><span class="p">,</span> <span class="n">adj_pvals</span><span class="p">,</span> <span class="n">sidak_aplha</span><span class="p">,</span> <span class="n">bonf_alpha</span> <span class="o">=</span> <span class="n">statsmodels</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">multitest</span><span class="o">.</span><span class="n">multipletests</span><span class="p">(</span><span class="n">pvals</span><span class="o">=</span><span class="n">pvals</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">'holm'</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Original p-values: </span><span class="se">\t</span><span class="s1"> </span><span class="si">{</span><span class="n">pvals</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Adjusted p-values: </span><span class="se">\t</span><span class="s1"> </span><span class="si">{</span><span class="n">adj_pvals</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code><span class="err">Original p-values:   [0.01, 0.04, 0.03]</span>
<span class="err">Adjusted p-values:   [0.03 0.06 0.06]</span>
</code></pre></div>
<h2 id="idk-correction">idk correction<a class="headerlink" href="#idk-correction" title="Permanent link">¶</a></h2>
<p>Source <a href="https://en.wikipedia.org/wiki/idk_correction">idk correction (Wikipedia)</a>.</p>
<p>idk correction keeps Type I error rate of exactly <span><span class="MathJax_Preview">\alpha</span><script type="math/tex">\alpha</script></span> when the tests are independent from each other and all null hypotheses are true. It is less stringent than the Bonferroni correction, but only slightly.</p>
<h3 id="algorithm-for-alphaalpha">Algorithm (for <span><span class="MathJax_Preview">\alpha</span><script type="math/tex">\alpha</script></span>)<a class="headerlink" href="#algorithm-for-alphaalpha" title="Permanent link">¶</a></h3>
<ol>
<li>Compute p-values <span><span class="MathJax_Preview">p_{1}, \dots, p_{m}</span><script type="math/tex">p_{1}, \dots, p_{m}</script></span> for all <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> hypotheses <span><span class="MathJax_Preview">H_{0}^{1}, \dots, H_{0}^{m}</span><script type="math/tex">H_{0}^{1}, \dots, H_{0}^{m}</script></span>.</li>
<li>Reject null hypothesis <span><span class="MathJax_Preview">H_{0}^{i}</span><script type="math/tex">H_{0}^{i}</script></span> if and only if associated p-value <span><span class="MathJax_Preview">p_{i}</span><script type="math/tex">p_{i}</script></span> is lower or equal than <span><span class="MathJax_Preview">\alpha_{SID} = 1 - (1 - \alpha)^{\frac{1}{m}}</span><script type="math/tex">\alpha_{SID} = 1 - (1 - \alpha)^{\frac{1}{m}}</script></span>.</li>
</ol>
<h3 id="algorithm-for-p-values">Algorithm (for p-values)<a class="headerlink" href="#algorithm-for-p-values" title="Permanent link">¶</a></h3>
<ol>
<li>Compute p-values <span><span class="MathJax_Preview">p_{1}, \dots, p_{m}</span><script type="math/tex">p_{1}, \dots, p_{m}</script></span> for all <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> hypotheses <span><span class="MathJax_Preview">H_{0}^{1}, \dots, H_{0}^{m}</span><script type="math/tex">H_{0}^{1}, \dots, H_{0}^{m}</script></span>.</li>
<li>Order p-values from lowest to highest <span><span class="MathJax_Preview">p_{(1)} \leq \dots \leq p_{(m)}</span><script type="math/tex">p_{(1)} \leq \dots \leq p_{(m)}</script></span></li>
<li>Calculate adjusted p-values <span><span class="MathJax_Preview">\tilde{p}_{(i)}</span><script type="math/tex">\tilde{p}_{(i)}</script></span> using formula
$$
 \tilde{p}<em _i_="(i)">{(i)}=
     \begin{cases}
        1 - (1 - p</em>)^{m} &amp; \text{for <span><span class="MathJax_Preview">i = 1</span><script type="math/tex">i = 1</script></span>},\
        \max \big{ \tilde{p}<em _i_="(i)">{(i-1)}, 1 - (1 - p</em>)^{m-i+1} \big} &amp; \text{for <span><span class="MathJax_Preview">i = 2, \dots, m</span><script type="math/tex">i = 2, \dots, m</script></span>}.
     \end{cases}
$$</li>
</ol>
<h3 id="example_2">Example<a class="headerlink" href="#example_2" title="Permanent link">¶</a></h3>
<div class="codehilite"><pre><span></span><code><span class="n">decision</span><span class="p">,</span> <span class="n">adj_pvals</span><span class="p">,</span> <span class="n">sidak_aplha</span><span class="p">,</span> <span class="n">bonf_alpha</span> <span class="o">=</span> <span class="n">statsmodels</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">multitest</span><span class="o">.</span><span class="n">multipletests</span><span class="p">(</span><span class="n">pvals</span><span class="o">=</span><span class="n">pvals</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">'sidak'</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Original p-values: </span><span class="se">\t</span><span class="s1"> </span><span class="si">{</span><span class="n">pvals</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Adjusted p-values: </span><span class="se">\t</span><span class="s1"> </span><span class="si">{</span><span class="n">adj_pvals</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code><span class="err">Original p-values:   [0.01, 0.04, 0.03]</span>
<span class="err">Adjusted p-values:   [0.029701 0.115264 0.087327]</span>
</code></pre></div>
<h2 id="confidence-interval-adjustment">Confidence Interval Adjustment<a class="headerlink" href="#confidence-interval-adjustment" title="Permanent link">¶</a></h2>
<p>After p-values adjustment for Multiple comparisons problem it is also necessary to appropriately adjust confidence intervals. Fortunately this is an easy problem and it does not depend on chosen method. We use duality between p-values and confidence intervals.</p>
<h3 id="algorithm_2">Algorithm<a class="headerlink" href="#algorithm_2" title="Permanent link">¶</a></h3>
<ol>
<li>Compute (original) p-values <span><span class="MathJax_Preview">p_{1}, \dots, p_{m}</span><script type="math/tex">p_{1}, \dots, p_{m}</script></span> for all <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> hypotheses <span><span class="MathJax_Preview">H_{0}^{1}, \dots, H_{0}^{m}</span><script type="math/tex">H_{0}^{1}, \dots, H_{0}^{m}</script></span>.</li>
<li>Based on chosen method compute adjusted p-values <span><span class="MathJax_Preview">\tilde{p}_{1}, \dots, \tilde{p}_{m}</span><script type="math/tex">\tilde{p}_{1}, \dots, \tilde{p}_{m}</script></span>.</li>
<li>Compute adjustment ratios <span><span class="MathJax_Preview">r_{1}, \dots, r_{m}</span><script type="math/tex">r_{1}, \dots, r_{m}</script></span> such that</li>
</ol>
<div>
<div class="MathJax_Preview">r_{i} = \frac{p_{i}}{\tilde{p}_{i}}, \,\,\, i = 1, \dots, m.</div>
<script type="math/tex; mode=display">r_{i} = \frac{p_{i}}{\tilde{p}_{i}}, \,\,\, i = 1, \dots, m.</script>
</div>
<ol>
<li>Let denote desired confidence level(s) as usual by <span><span class="MathJax_Preview">\alpha</span><script type="math/tex">\alpha</script></span>, e.g. <span><span class="MathJax_Preview">\alpha = 0.05</span><script type="math/tex">\alpha = 0.05</script></span>. More precisely let assume <span><span class="MathJax_Preview">\alpha_{1}, \dots, \alpha_{m}</span><script type="math/tex">\alpha_{1}, \dots, \alpha_{m}</script></span>.</li>
<li>Compute adjusted confidence levels <span><span class="MathJax_Preview">\tilde{\alpha}_{1}, \dots, \tilde{\alpha}_{m}</span><script type="math/tex">\tilde{\alpha}_{1}, \dots, \tilde{\alpha}_{m}</script></span> such that</li>
</ol>
<div>
<div class="MathJax_Preview">\tilde{\alpha_{i}} = r \, \alpha_{i}.</div>
<script type="math/tex; mode=display">\tilde{\alpha_{i}} = r \, \alpha_{i}.</script>
</div>
<ol>
<li>Compute <span><span class="MathJax_Preview">(1 - \alpha_{i})</span><script type="math/tex">(1 - \alpha_{i})</script></span>-confidence intervals such that you use <span><span class="MathJax_Preview">\tilde{\alpha}_{i}</span><script type="math/tex">\tilde{\alpha}_{i}</script></span> instead of <span><span class="MathJax_Preview">\alpha_{i}</span><script type="math/tex">\alpha_{i}</script></span>.</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Computed confidence intervals using <span><span class="MathJax_Preview">\tilde{\alpha}_{i}</span><script type="math/tex">\tilde{\alpha}_{i}</script></span> instead of <span><span class="MathJax_Preview">\alpha_{i}</span><script type="math/tex">\alpha_{i}</script></span> are actually <span><span class="MathJax_Preview">(1 - \alpha_{i})</span><script type="math/tex">(1 - \alpha_{i})</script></span>-confidence intervals. Levels of significance DO NOT change, they are still <span><span class="MathJax_Preview">1 - \alpha_{i}</span><script type="math/tex">1 - \alpha_{i}</script></span>, not <span><span class="MathJax_Preview">1 - \tilde{\alpha}_{i}</span><script type="math/tex">1 - \tilde{\alpha}_{i}</script></span>.</p>
</div>
<h3 id="example_3">Example<a class="headerlink" href="#example_3" title="Permanent link">¶</a></h3>
<p>Unadjusted p-value is <span><span class="MathJax_Preview">p_{i} = 0.01</span><script type="math/tex">p_{i} = 0.01</script></span>. Adjusted p-value is <span><span class="MathJax_Preview">\tilde{p}_{i} = 0.03</span><script type="math/tex">\tilde{p}_{i} = 0.03</script></span>. Adjustment ratio is <span><span class="MathJax_Preview">r = 1/3</span><script type="math/tex">r = 1/3</script></span>. Desired level of significance is <span><span class="MathJax_Preview">\alpha = 0.05</span><script type="math/tex">\alpha = 0.05</script></span>. Adjusted level of significance is <span><span class="MathJax_Preview">\tilde{\alpha} = 0.05 \cdot 1/3 = 0.01667</span><script type="math/tex">\tilde{\alpha} = 0.05 \cdot 1/3 = 0.01667</script></span>. So we need to compute <span><span class="MathJax_Preview">1 - 0.01667 = 0.983 = 98.3\%</span><script type="math/tex">1 - 0.01667 = 0.983 = 98.3\%</script></span>-confidence interval in order to get <span><span class="MathJax_Preview">95\%</span><script type="math/tex">95\%</script></span>-confidence interval.</p>
<h2 id="python-package">Python package<a class="headerlink" href="#python-package" title="Permanent link">¶</a></h2>
<p>Link to documentation of <a href="https://www.statsmodels.org/dev/generated/statsmodels.stats.multitest.multipletests.html">Statsmodels package</a>.</p>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav aria-label="Footer" class="md-footer-nav__inner md-grid">
<a class="md-footer-nav__link md-footer-nav__link--prev" href="ctr.html" rel="prev" title="CTR Metric Redefined">
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</div>
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Previous
                </span>
                CTR Metric Redefined
              </div>
</div>
</a>
<a class="md-footer-nav__link md-footer-nav__link--next" href="../api/experiment.html" rel="next" title="Experiment">
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Next
                </span>
                Experiment
              </div>
</div>
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"></path></svg>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
<div class="md-footer-copyright__highlight">
            Copyright © 2020 Maintained by <a href="https://github.com/avast">Avast</a>.
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
          Material for MkDocs
        </a>
</div>
</div>
</div>
</footer>
</div>
<script src="../assets/javascripts/vendor.3636a4ec.min.js"></script>
<script src="../assets/javascripts/bundle.e9fe3281.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
<script>
        app = initialize({
          base: "..",
          features: ["tabs"],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.5eca75d3.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</body>
</html>